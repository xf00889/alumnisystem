{% extends "donations/base.html" %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Donors" %} - {{ campaign.name }} | {{ block.super }}{% endblock %}

{% block extra_css %}
{{ block.super }}
<style>
    /* Mobile Responsive Styles for Campaign Donors */
    @media (max-width: 768px) {
        .display-5 {
            font-size: 1.25rem !important;
        }
        
        .lead {
            font-size: 0.875rem !important;
        }
        
        .breadcrumb {
            font-size: 0.75rem !important;
            padding: 0.5rem 0.75rem !important;
        }
        
        .breadcrumb-item {
            font-size: 0.75rem !important;
        }
        
        h1 {
            font-size: 1.25rem !important;
        }
        
        h5 {
            font-size: 0.9375rem !important;
        }
        
        .card-header {
            padding: 0.75rem !important;
        }
        
        .card-body {
            padding: 0.75rem !important;
        }
        
        .card-footer {
            padding: 0.75rem !important;
        }
        
        .badge {
            font-size: 0.75rem !important;
            padding: 0.35em 0.65em !important;
        }
        
        .table {
            font-size: 0.75rem !important;
        }
        
        .table thead th {
            font-size: 0.75rem !important;
            padding: 0.5rem 0.25rem !important;
        }
        
        .table tbody td {
            font-size: 0.7rem !important;
            padding: 0.5rem 0.25rem !important;
        }
        
        .alert {
            font-size: 0.75rem !important;
            padding: 0.75rem !important;
        }
        
        .btn {
            font-size: 0.8125rem !important;
            padding: 0.5rem 1rem !important;
        }
        
        /* Stack table on mobile */
        .table-responsive {
            border: 0;
        }
        
        .table thead {
            display: none;
        }
        
        .table tbody tr {
            display: block;
            margin-bottom: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            background: white;
        }
        
        .table tbody td {
            display: block;
            text-align: right;
            padding: 0.5rem 0.75rem !important;
            border: none;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .table tbody td:last-child {
            border-bottom: none;
        }
        
        .table tbody td::before {
            content: attr(data-label);
            float: left;
            font-weight: bold;
            color: #6c757d;
        }
        
        .table-light td {
            background-color: #f8f9fa !important;
        }
    }
    
    @media (max-width: 576px) {
        .display-5 {
            font-size: 1.125rem !important;
        }
        
        .lead {
            font-size: 0.8125rem !important;
        }
        
        .breadcrumb {
            font-size: 0.7rem !important;
        }
        
        h5 {
            font-size: 0.875rem !important;
        }
        
        .badge {
            font-size: 0.7rem !important;
        }
        
        .table tbody td {
            font-size: 0.65rem !important;
            padding: 0.4rem 0.625rem !important;
        }
        
        .alert {
            font-size: 0.7rem !important;
            padding: 0.625rem !important;
        }
        
        .btn {
            font-size: 0.75rem !important;
            padding: 0.5rem 0.875rem !important;
        }
    }
</style>
{% endblock %}

{% block donations_content %}
<div class="mb-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'donations:campaign_list' %}">{% trans "Campaigns" %}</a></li>
            <li class="breadcrumb-item"><a href="{{ campaign.get_absolute_url }}">{{ campaign.name }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{% trans "Donors" %}</li>
        </ol>
    </nav>
    
    <h1 class="display-5 fw-bold">{% trans "Campaign Donors" %}</h1>
    <p class="lead">{% blocktrans with name=campaign.name %}All donors who have contributed to {{ name }}.{% endblocktrans %}</p>
</div>

<div class="card mb-4">
    <div class="card-header bg-light">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">{% trans "Donor List" %}</h5>
            <span class="badge bg-primary rounded-pill">
                {{ donations|length }} {% if anonymous_count > 0 %}+ {{ anonymous_count }} {% trans "anonymous" %}{% endif %}
            </span>
        </div>
    </div>
    
    {% if donations %}
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>{% trans "Donor" %}</th>
                    <th>{% trans "Amount" %}</th>
                    <th>{% trans "Date" %}</th>
                    <th>{% trans "Message" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for donation in donations %}
                <tr>
                    <td data-label="{% trans 'Donor' %}">
                        {% if donation.is_anonymous %}
                            <i class="fas fa-user-secret me-1"></i> {% trans "Anonymous" %}
                        {% elif donation.donor %}
                            {{ donation.donor.get_full_name }}
                        {% else %}
                            {{ donation.donor_name|default:"Anonymous" }}
                        {% endif %}
                    </td>
                    <td data-label="{% trans 'Amount' %}">â‚±{{ donation.amount|floatformat:2 }}</td>
                    <td data-label="{% trans 'Date' %}">{{ donation.donation_date|date:"M d, Y" }}</td>
                    <td data-label="{% trans 'Message' %}">
                        {% if donation.message %}
                            {{ donation.message|truncatechars:100 }}
                        {% else %}
                            <span class="text-muted">{% trans "No message" %}</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                
                {% if anonymous_count > 0 %}
                <tr class="table-light">
                    <td colspan="4">
                        <i class="fas fa-user-secret me-2"></i> 
                        <strong>{% trans "Anonymous Donors" %}:</strong>
                        {% blocktrans with count=anonymous_count %}
                        {{ count }} donors have chosen to remain anonymous.
                        {% endblocktrans %}
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="card-body">
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i> 
            {% if anonymous_count > 0 %}
                {% blocktrans with count=anonymous_count %}
                All {{ count }} donors have chosen to remain anonymous.
                {% endblocktrans %}
            {% else %}
                {% trans "No donations have been made to this campaign yet." %}
            {% endif %}
        </div>
    </div>
    {% endif %}
    
    <div class="card-footer">
        <a href="{{ campaign.get_absolute_url }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> {% trans "Back to Campaign" %}
        </a>
    </div>
</div>
{% endblock %} 