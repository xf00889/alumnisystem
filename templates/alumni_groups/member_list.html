{% if members %}
<div class="members-grid">
    {% for member in members %}
    <div class="member-grid-item">
        <img src="{% if member.user.profile.avatar %}{{ member.user.profile.avatar.url %}{% else %}/static/images/default-avatar.png{% endif %}" 
             alt="{{ member.user.get_full_name }}"
             class="member-grid-avatar">
        <div class="member-grid-info">
            <h6 class="member-grid-name">{{ member.user.get_full_name }}</h6>
            <p class="member-grid-email">{{ member.user.email }}</p>
            <span class="badge badge-role role-{{ member.role|lower }}">
                {{ member.get_role_display }}
            </span>
        </div>
        {% if member.joined_at %}
        <div class="member-grid-joined">
            <small>Joined {{ member.joined_at|date:"M d, Y" }}</small>
        </div>
        {% endif %}
        <div class="member-grid-actions">
            {% if member.status == 'PENDING' %}
                {% if group.has_security_questions %}
                    <button type="button" 
                            class="btn btn-info btn-sm view-answers"
                            data-membership-id="{{ member.id }}"
                            title="View Answers">
                        <i class="fas fa-shield-alt"></i>
                    </button>
                {% endif %}
                <button type="button" 
                        class="btn btn-success btn-sm member-action"
                        data-action="approve"
                        data-membership-id="{{ member.id }}"
                        title="Approve">
                    <i class="fas fa-check"></i>
                </button>
                <button type="button" 
                        class="btn btn-danger btn-sm member-action"
                        data-action="reject"
                        data-membership-id="{{ member.id }}"
                        title="Reject">
                    <i class="fas fa-times"></i>
                </button>
            {% elif member.status == 'APPROVED' %}
                {% if member.role != 'ADMIN' %}
                    <button type="button" 
                            class="btn btn-primary btn-sm member-action"
                            data-action="promote"
                            data-membership-id="{{ member.id }}"
                            title="Make Admin">
                        <i class="fas fa-user-shield"></i>
                    </button>
                    <button type="button" 
                            class="btn btn-danger btn-sm member-action"
                            data-action="remove"
                            data-membership-id="{{ member.id }}"
                            title="Remove">
                        <i class="fas fa-user-minus"></i>
                    </button>
                {% endif %}
            {% elif member.status == 'REJECTED' or member.status == 'BLOCKED' %}
                <button type="button" 
                        class="btn btn-warning btn-sm member-action"
                        data-action="reinstate"
                        data-membership-id="{{ member.id }}"
                        title="Reinstate">
                    <i class="fas fa-user-plus"></i>
                </button>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <i class="fas fa-users"></i>
    <p>No members found in this category.</p>
</div>
{% endif %}
